# Noteing for Node.js

### ~1107(1 ~ 19)

요약

- 웹서버 생성
- URL 값 이용
- 쿼리스트링 이용 동적 웹 페이지 url.parse().query
- 파일 읽어오기 fs
- 오류 페이지 구현

.

자바스크립트가 웹 브라우저를 제어한다면,

Node.js는 자바스크립트를 이용해 웹 브라우저가 아닌 컴퓨터 자체를 제어한다

이를 통해 자바스크립트는 웹 브라우저 밖으로 팽창 할 수 있었고,

웹 페이지를 동적으로 생성하는 애플리케이션도 만들 수 있었다

.

자바스크립트를 통해, Node.js 기능을 실행해서, Node.js 애플리케이션을 만든다

.

Node.js로 로컬 서버를 만들 수 있다

아직 코드를 전부 이해하진 못했다

근데 대충 creatServer() 이게 서버 생성해주는 메소드인듯

.

**response.end()**는 웹 브라우저의 요청에 응답하는 명령이다

즉, 사용자의 화면에 비치는 것을 조작(응답)한다

.

url은

프로토콜://호스트(도메인 네임):포트번호/경로?쿼리스트링

http://localhost:3000/main?id=HTML

이렇게 이뤄진다

이때 쿼리 스트링을 이용하면 id 값에 따라

사용자에게 적당한 콘텐츠를 보여줄 수 있다

.

url 모듈을 이용해 쿼리스트링을 추출 할 수 있다

url.parse(_url, true).query

parse : 분석하다

.

정보시스템에서 정보를 다루는 4가지 핵심 처리 방법을

CRUD(Creat, Read, Update, Delete)라고 한다

이 중 생성이 제일 중요하고, 그 다음으로 읽기가 중요하다

.

fs 모듈에는 파일을 다루는 여러 가지 기능이 있다

파일 읽기 - 

fs.readFile('sample.txt', 'uft8', function(err, data){ })

.

url.parse(_url, true).query 에서 

query 말고 pathname을 통해

쿼리 스트링을 제외한 경로를 추출 할 수 있다

이를 이용해 루트 접속이 아닐 시

응답 코드 404를 적시하여 에러 페이지를 구현 할 수 있다

참고로 응답 코드 200은 파일의 성공적 전송을 뜻한다

***

### 1108(20 ~ 29)

fs.readdir('./data', function(error, filelist){ }) ㅐ

을 통해 파일 목록을 추출 할 수 있다

파일 목록은 콜백의 두 번째 매개변수에 배열의 형태로 전달됨

.

하나의 작업이 끝날 때까지 기다렸다가 다음 작업을 처리하는 방식을

**동기 처리 방식**

병렬로 동시에 여러 가지 일을 처리하는 방식을

**비동기 처리 방식**

이라고 한다

.

Node.js에는 비동기 처리를 하기 위한 좋은 기능들이 많으며 선호하는 편이다

아마 이유는 서버 관리에 비동기 처리가 필연적이기 때문일듯

효율적이긴 한데 근데 좀 복잡하다고 한다

대충 Sync이 붙으면 동기이고 없으면 비동기처리 방식이다

.

**비동기 처리**는 실행 흐름과 별도로 동작해서 처리 시간이 실행 흐름에 영향을 미치지 않는다

이 비동기 방식에는 **콜백**을 쓰는 것이 필요한 듯

<u>어떤 실행문을 마치면 내부적으로 자동 호출하는 기능임</u>

.

콜백 개념에 앞서서

함수를 정의하는 새로운 메커니즘으로 **익명함수**가 있다

이는 변수 뒤에 함수 호출 연산자 ()를 지정 함으로써

변수에 담긴 함수를 호출 할 수 있다

이 원리를 이용해 함수를 매개 변수로 주고 받는 콜백을 쓰는 듯

.

**패키지**는 소프트웨어를 일컫는 여러 표현 중 하나이며

이를 관리하는 프로그램이 **패키지 매니저**이다

Node.js에 기본 적으로 탑재 되어있는 패키지 매니저로 **npm**이 있다

그리고 이 패키지 매니저로 **pm2**라는 프로세스 관리 프로그램을 설치 할 수 있다

npm install pm2 -g

아마 pm2가 대충 여기서 패키지 개념으로 보면 되는 듯

진짜 편한 프로그램인 것 같긴 한데, 잘 작동도 안되고 윤태도 모른단다...

대충 프로그램을 감시하고 실시간으로 현황을 파악함과 동시에 편의 기능들을 제공하는듯

***

### 1110(30 ~ 32)

지금까지는 서버(nodejs)를 통해 사용자(웹 브라우저)에 응답하는 내용을 주로 다뤘다

오늘은 form 주축으로 사용자에서 서버로 요청하는 내용을 추가로 배웠다

.

HTML의 form을 요약하자면

input에 내용을 입력하고 submit으로 이벤트를 발생시키면

form에 달려있는 도메인으로 내용을 전송한다

.

이때 method를 디폴트 값인 get이 아닌 post로 바꾸는게 일반적이다

post는 눈에 보이지 않는 방식이며, 안전하고 큰 데이터를 보낼 수 있게 해준다

그냥 서버에 수정 행위를 통틀어서 post를 쓰는게 일반적인듯 하다

이미 서버에 풀려있는 정보는 공개적으로 불러와도(get) 상관이 없고

오히려 활용 할 수 있는 부분이 될 수 있지만

개인의 정보를 서버에 보낼때는 민감한 정보는 되도록 숨기며, 

안전하게 보내는 것(post)이 필요하기 때문

.

개발자 도구에 network 탭을 이용해 정보의 흐름을 볼 수 있다

.

http.createServer의 request를 통해 웹 브라우저가 보낸 정보를 다를 수 있다

앞서 말했듯이 post는 큰 정보를 보낼때도 쓰인다

아마 이를 대비해서 서버가 데이터를 수신할 때 여러 단계로 나누어 수신한다

수신 받을 때마다 data 이벤트를 통해 데이터를 처리하고,

수신이 완료되면 데이터 처리를 마무리 한다

당연한 얘기지만 객체 형태로 온다

parse(divide a sentence)를 통해 요소들 추출 가능

***

### 211114(33)

맨탈 깨져서 아무것도 못함

.

fs.writeFile을 이용해서 파일 생성 하는 것까진 쉽게 따라감

근데 리다이렉션은 아무리 해도 안된다 윤태한테 물어봐야 될듯
